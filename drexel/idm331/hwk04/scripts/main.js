import*as THREE from"../../scripts/ThreeJS.js";import{GLTFLoader}from"../../scripts/GLTFLoader.js";import{OrbitControls}from"../../scripts/OrbitControls.js";const docQ=document.querySelector.bind(document),docQA=document.querySelectorAll.bind(document),myWorldObj=document.getElementById("myWorld"),scene=new THREE.Scene;scene.background=new THREE.Color(47103);const ambLight=new THREE.AmbientLight(1052688,50);scene.add(ambLight);const camera=new THREE.PerspectiveCamera(45,myWorldObj.scrollWidth/myWorldObj.scrollHeight,1,1e3);camera.position.z=-50;const renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0});function controlsRender(){renderer.render(scene,camera)}renderer.setSize(myWorldObj.scrollWidth,myWorldObj.scrollHeight),myWorldObj.appendChild(renderer.domElement),renderer.setClearColor(0,0);let controlsObj=new OrbitControls(camera,myWorldObj);controlsObj.addEventListener("change",controlsRender);const planes=[{name:"1_rightPlane",startPosZ:775,startPosX:-30},{name:"1_midLeftPlane",startPosZ:750,startPosX:-15},{name:"1_centerPlane",startPosZ:725,startPosX:0},{name:"1_midRightPlane",startPosZ:750,startPosX:15},{name:"1_rightPlane",startPosZ:775,startPosX:30},{name:"2_midLeftPlane",startPosZ:850,startPosX:-15},{name:"2_centerPlane",startPosZ:825,startPosX:0},{name:"2_midRightPlane",startPosZ:850,startPosX:15}];let animateReady=!1,i=0;planes.forEach(e=>{let t;i++;(new GLTFLoader).setPath("./assets/plane/").load("scene.gltf",function(o){t=o.scene,e.ref=t,t.position.z=e.startPosZ,t.position.x=e.startPosX,t.position.y=15,t.rotation.y=-45.5,scene.add(t)},function(t){const o=Math.round(t.loaded/t.total*100);if(e.complete=o>=100,i>=planes.length){let e=0;planes.forEach(t=>{t.complete&&e++,e!=planes.length||(animateReady=!0)})}},function(e){console.log("loaderObj ERROR: ",e)})});let paused=!0,mute=!0;const loadingModal=docQ("#loading"),controlsModal=docQ("#controls");setTimeout(()=>{paused=!1,loadingModal.hidden=!0,controlsModal.hidden=!1,mute=!1,bgm.play()},3e3);const toggleAnimBtn=docQ(".toggleAnim");toggleAnimBtn.addEventListener("click",()=>{paused=!paused});const animate=function(){requestAnimationFrame(animate),animateReady&&(loadingModal.classList.add("ready"),paused||planes.forEach(e=>{const t=e.ref;t&&(t.position.z<=e.startPosZ/2*-1?t.position.z=e.startPosZ:t.position.z-=1)}),renderer.render(scene,camera))};animate();const bgm=new Audio("./assets/bgm.mp3"),toggleMusic=docQ(".toggleMusic");toggleMusic.addEventListener("click",()=>{mute?bgm.play():bgm.pause(),mute=!mute});